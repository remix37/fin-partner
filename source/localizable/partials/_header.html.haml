%nav.navbar.navbar-default.navbar-fixed-top
  .container
    / Brand and toggle get grouped for better mobile display
    .navbar-header
      %button.navbar-toggle.collapsed{"aria-expanded" => "false", "data-target" => "#NavbarCollapse", "data-toggle" => "collapse", :type => "button"}
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar

      - if lang == :en
        %a.navbar-brand{:href => "/"}
          %img.logo{:src => image_path('fin-partners_logo.png'), :srcset => " #{image_path('fin-partners_logo@2x.png')} 2x, #{image_path('fin-partners_logo.png')} 1x"}/
      - else
        %a.navbar-brand{:href => "/#{I18n.locale}/"}
          %img.logo{:src => image_path('fin-partners_logo.png'), :srcset => " #{image_path('fin-partners_logo@2x.png')} 2x, #{image_path('fin-partners_logo.png')} 1x"}/


    / Collect the nav links, forms, and other content for toggling
    #NavbarCollapse.collapse.navbar-collapse
      %ul.nav.navbar-nav.visible-sm
        %li.dropdown

          %a.dropdown-toggle{"aria-expanded" => "false", "aria-haspopup" => "true", "data-toggle" => "dropdown", :href => "#", :role => "button"}
            %span.glyphicon.glyphicon-menu-hamburger
            Menu

          %ul.dropdown-menu
            - if lang == :en

              %li{ nav_active('about-us.html') }
                = link_to "/about-us.html" do
                  - t("menu").drop(0).first(1).each do |nav|
                    = nav

              %li{ nav_active('what-we-do.html') }
                = link_to "/what-we-do.html" do
                  - t("menu").drop(1).first(1).each do |nav|
                    = nav

              %li{ nav_active('contact-us.html') }
                = link_to "/contact-us.html" do
                  - t("menu").drop(2).first(1).each do |nav|
                    = nav

            - else

              %li{ nav_active("#{I18n.locale}/about-us.html") }
                = link_to "/#{I18n.locale}/about-us.html" do
                  - t("menu").drop(0).first(1).each do |nav|
                    = nav

              %li{ nav_active("#{I18n.locale}/what-we-do.html") }
                = link_to "/#{I18n.locale}/what-we-do.html" do
                  - t("menu").drop(1).first(1).each do |nav|
                    = nav

              %li{ nav_active("#{I18n.locale}/contact-us.html") }
                = link_to "/#{I18n.locale}/contact-us.html" do
                  - t("menu").drop(2).first(1).each do |nav|
                    = nav

      %ul.nav.navbar-nav.visible-md.visible-lg.visible-xs

        - if lang == :en

          %li{ nav_active('about-us.html') }
            = link_to "/about-us.html" do
              - t("menu").drop(0).first(1).each do |nav|
                = nav

          %li{ nav_active('what-we-do.html') }
            = link_to "/what-we-do.html" do
              - t("menu").drop(1).first(1).each do |nav|
                = nav

          %li{ nav_active('contact-us.html') }
            = link_to "/contact-us.html" do
              - t("menu").drop(2).first(1).each do |nav|
                = nav

        - else

          %li{ nav_active("#{I18n.locale}/about-us.html") }
            = link_to "/#{I18n.locale}/about-us.html" do
              - t("menu").drop(0).first(1).each do |nav|
                = nav

          %li{ nav_active("#{I18n.locale}/what-we-do.html") }
            = link_to "/#{I18n.locale}/what-we-do.html" do
              - t("menu").drop(1).first(1).each do |nav|
                = nav

          %li{ nav_active("#{I18n.locale}/contact-us.html") }
            = link_to "/#{I18n.locale}/contact-us.html" do
              - t("menu").drop(2).first(1).each do |nav|
                = nav

      %ul.nav.navbar-nav.navbar-right

        %li.dropdown

          %a.dropdown-toggle{"aria-expanded" => "false", "aria-haspopup" => "true", "data-toggle" => "dropdown", :href => "#", :role => "button"}

            - if lang == :en
              %img{:src => image_path('flags/flag-uk.png'), :srcset => " #{image_path('flags/flag-uk@2x.png')} 2x, #{image_path('flags/flag-uk.png')} 1x"}/
            - elsif lang == :fr
              %img{:src => image_path('flags/flag-fr.png'), :srcset => " #{image_path('flags/flag-fr@2x.png')} 2x, #{image_path('flags/flag-fr.png')} 1x"}/
            - else
              %img{:src => image_path('flags/flag-es.png'), :srcset => " #{image_path('flags/flag-es@2x.png')} 2x, #{image_path('flags/flag-es.png')} 1x"}/

            %span.hidden-sm
              = t("flag.title")
            %span.caret

          %ul.dropdown-menu
            %li
              - if clean_from_i18n(current_page.url) == ""
                %a{:href => "/"}
                  - t("languages").drop(0).first(1).each do |lang|
                    = lang
              - else
                = link_to "#{clean_from_i18n(current_page.url)}" do
                  - t("languages").drop(0).first(1).each do |lang|
                    = lang
            %li
              = link_to path(current_page.url, lang: :fr) do
                - t("languages").drop(1).first(1).each do |lang|
                  = lang
            %li
              = link_to path(current_page.url, lang: :es) do
                - t("languages").drop(2).first(1).each do |lang|
                  = lang
